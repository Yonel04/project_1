import{d as Z,u as ee,r as p,f as M,w as te,c5 as se,e as le,bR as G,g as ae,aJ as ne,bN as P,j as n,k as o,q as s,l as C,bG as oe,by as ce,s as b,be as d,n as k,x as f,v as ie,t as x,aF as g,a as ue,c1 as re,aV as de,aS as ve,_ as he}from"./entry.a5ffe6b6.js";import pe from"./IconButton.3d0339e3.js";import{l as w}from"./locale.83ca1a04.js";function V(m){let v,_=m[0],I=1;for(;I<m.length;){const u=m[I],q=m[I+1];if(I+=2,(u==="optionalAccess"||u==="optionalCall")&&_==null)return;u==="access"||u==="optionalAccess"?(v=_,_=q(_)):(u==="call"||u==="optionalCall")&&(_=q((...W)=>_.call(v,...W)),v=void 0)}return _}const _e=m=>(de("data-v-1597c2a6"),m=m(),ve(),m),ye={class:"search-btn"},fe={class:"filter-left"},me={class:"filter-title"},ke={key:0,class:"filter-buttons"},ge={key:0,class:"filter-item"},we={class:"filter-category"},Ce={class:"panel-content"},be=["onClick"],Ie={key:1,class:"filter-item"},Le={class:"filter-category"},Se={class:"panel-content"},xe=["onClick"],Te={key:2,class:"filter-item"},Fe={class:"filter-category"},Ae={class:"panel-content"},$e=["onClick"],qe=_e(()=>s("div",{class:"mobile-filters--background"},null,-1)),Ne={class:"mobile-filters--container"},Ee={class:"container-top"},Me={class:"h5"},Ve={key:0,class:"tags"},Be=["onClick"],Pe={class:"uppercase p5 xl:p5d"},We={class:"filter-buttons"},Oe={class:"s1"},De={class:"panel-content"},He=["onClick"],Re={class:"s1"},Ue={class:"panel-content"},je=["onClick"],ze={class:"s1"},Ge={class:"panel-content"},Je=["onClick"],Ke=Z({__name:"SearchFilters",props:{searchList:{type:Array,required:!0},tagsList:{type:Array,required:!0},searchType:{type:String,required:!1}},emits:["change","searchName","tags"],async setup(m,{emit:v}){let _,I;const u=m,{locale:q}=ee(),W=p([]),T=p([]),F=p([]),A=p([]),B=p(),N=p(""),y=p([...u.searchList]);let $=[...u.searchList];const H=p(!1),R=p(!1);M(()=>u.searchList,l=>{if(u.searchType==="work"){if(H.value)return;H.value=!0}else{if(R.value)return;R.value=!0}y.value=l,$=[...l]});const J=u.searchType&&u.searchType==="work"?"searchFiltersWorks":"searchFiltersInsight";[_,I]=te(async()=>se(J,async({$contentful:l,$previewContentful:a})=>{const e=ue().query.preview=="true"?a:l;try{let t=null;u.searchType&&u.searchType==="work"?t=await e.getEntries({"sys.contentType.sys.id[in]":"sector,caseStudy,service",locale:q.value}):t=await e.getEntries({"sys.contentType.sys.id[in]":"sector,news,insight,service",locale:q.value}),t=t.items.map(h=>({title:h.fields.title,type:h.sys.contentType.sys.id})),u.searchType&&u.searchType==="work"?T.value=[{title:"Awards",type:"awarded"},{title:"Popular",type:"popular"}]:T.value=[{title:"News",type:"news"},{title:"Insight",type:"insight"}],F.value=t.filter(h=>h.type==="sector"&&h.title),A.value=t.filter(h=>h.type==="service"&&h.title),W.value=t}catch(t){console.warn("Problem fetching related data 4",t)}},"$eTH4MN5nw8")),_=await _,I();const O=le(()=>G.isMobile),E=p(!1),K=()=>{O.value&&(E.value=!E.value)},Q=()=>{E.value=!1},L=p([]),D=l=>{L.value.includes(l)?L.value=L.value.filter(a=>a!==l):L.value.push(l)};M(N,(l,a)=>{if(l===""){y.value=$,v("change",y.value),v("searchName","");return}y.value=$.filter(r=>r.fields.title.toLowerCase().includes(l.toLowerCase())),v("change",y.value),v("searchName",N.value)});const i=p(u.tagsList);[...u.tagsList];const S=(l,a=!1)=>{if(a||(i.value.includes(l)?i.value=i.value.filter(c=>c!==l):i.value.push(l)),i.value.length===0){y.value=$,v("change",y.value),v("tags",i.value);return}const r=$.map(c=>({...c,show:!1}));i.value.forEach(c=>{c==="awarded"||c==="popular"||c==="news"||c==="insight"?c==="news"||c==="insight"?r.forEach(e=>{e.sys.contentType.sys.id===c&&(e.show=!0)}):(c==="awarded"||c==="popular")&&r.filter(e=>{V([e,"access",t=>t.fields,"access",t=>t.tags,"optionalAccess",t=>t.some,"call",t=>t(h=>h.toLowerCase()===c.toLowerCase())])&&(e.show=!0)}):F.value.some(e=>e.title===c)?r.filter(e=>{V([e,"access",t=>t.fields,"access",t=>t.sector,"optionalAccess",t=>t.fields,"access",t=>t.title])===c&&(e.show=!0),V([e,"access",t=>t.fields,"access",t=>t.sectors,"optionalAccess",t=>t.some,"call",t=>t(h=>h.fields.title===c)])&&(e.show=!0)}):A.value.some(e=>e.title===c)?r.filter(e=>{V([e,"access",t=>t.fields,"access",t=>t.service,"optionalAccess",t=>t.fields,"access",t=>t.name])===c&&(e.show=!0),V([e,"access",t=>t.fields,"access",t=>t.services,"optionalAccess",t=>t.some,"call",t=>t(h=>h.fields.name===c)])&&(e.show=!0)}):r.filter(e=>{e.fields.title===c&&(e.show=!0)}),y.value=r.filter(e=>e.show)}),v("change",y.value),v("tags",i.value)};M(()=>i,(l,a)=>{v("tags",l)}),M(()=>u.tagsList,(l,a)=>{i.value=l,S("",!0)});const X=l=>{i.value=i.value.filter(a=>a!==l)};ae(()=>{document.body.addEventListener("click",U)}),ne(()=>{document.body.removeEventListener("click",U)}),p(!1);const U=l=>{B.value.contains(l.target)||j()};M(N,(l,a)=>{l&&l!==""?Y():l===""&&j()});const Y=()=>{if(!G.isMobile)return;const l=P.timeline(),a=P.utils.selector(B.value);l.to(a(".filters"),{scale:0,duration:.5,ease:"quart.out"},0).set(a(".filters"),{display:"none"},0).to(a(".search-btn input"),{width:"82vw",maxWidth:"100%",duration:.5,ease:"quart.out"},0)},j=()=>{const l=P.timeline(),a=P.utils.selector(B.value);l.set(a(".filters"),{display:"flex"},0).to(a(".filters"),{scale:"1",duration:.5,ease:"quart.out"},0).to(a(".search-btn input"),{width:"auto",maxWidth:"164px",duration:.5,ease:"quart.out"},0)},z=()=>{i.value=[],y.value=$,v("change",y.value),v("tags",i.value)};return(l,a)=>{const r=re,c=pe;return n(),o(b,null,[s("div",{class:"search-filters",ref_key:"root",ref:B},[s("div",ye,[C(r,{name:"search-filters"}),oe(s("input",{class:"p5 xl:p5s","onUpdate:modelValue":a[0]||(a[0]=e=>N.value=e),type:"text",placeholder:"Search"},null,512),[[ce,N.value]])]),s("div",{class:"filters p5 xl:p5d",onClick:K},[s("div",fe,[O.value?(n(),ie(r,{key:1,name:"filter",outline:!0})):(n(),o(b,{key:0},[s("span",me,d(k(w).data.searchItem4||"Filters"),1),i.value.length>0?(n(),o("button",{key:0,onClick:z},d(k(w).data.searchItem5||"Clear All"),1)):f("",!0)],64))]),O.value?f("",!0):(n(),o("div",ke,[T.value.length?(n(),o("div",ge,[s("button",we,[s("span",null,d(k(w).data.searchItem0||"Content"),1),C(r,{name:"chevron-down"})]),s("div",Ce,[s("ul",null,[(n(!0),o(b,null,x(T.value,e=>(n(),o("li",{key:e,class:g({active:i.value.includes(e.type)}),onClick:t=>S(e.type)},[s("button",null,d(e.title),1)],10,be))),128))])])])):f("",!0),F.value.length?(n(),o("div",Ie,[s("button",Le,[s("span",null,d(k(w).data.searchItem1||"Sectors"),1),C(r,{name:"chevron-down"})]),s("div",Se,[s("ul",null,[(n(!0),o(b,null,x(F.value,e=>(n(),o("li",{key:e,class:g({active:i.value.includes(e.title)}),onClick:t=>S(e.title)},[s("button",null,d(e.title),1)],10,xe))),128))])])])):f("",!0),A.value.length?(n(),o("div",Te,[s("button",Fe,[s("span",null,d(k(w).data.searchItem2||"Services"),1),C(r,{name:"chevron-down"})]),s("div",Ae,[s("ul",null,[(n(!0),o(b,null,x(A.value,e=>(n(),o("li",{key:e,class:g({active:i.value.includes(e.title)}),onClick:t=>S(e.title)},[s("button",null,d(e.title),1)],10,$e))),128))])])])):f("",!0)]))])],512),E.value?(n(),o("div",{key:0,class:g(["mobile-filters",{"is-open":E.value}])},[qe,s("div",Ne,[s("div",Ee,[s("h5",Me,d(k(w).data.searchItem4||"Filters"),1),s("div",null,[i.value.length>0?(n(),o("button",{key:0,onClick:z},d(k(w).data.searchItem5||"Clear all"),1)):f("",!0),C(c,{theme:"white",name:"close",onClick:Q})])]),i.value.length>0?(n(),o("div",Ve,[(n(!0),o(b,null,x(l.tags,e=>(n(),o("div",{class:"tag-item",onClick:t=>X(e),key:e.id},[C(r,{name:"close",outline:!0}),s("span",Pe,d(e),1)],8,Be))),128))])):f("",!0),s("div",We,[T.value.length?(n(),o("div",{key:0,class:g(["filter-item",{active:L.value.includes("content")}])},[s("button",{class:"filter-category",onClick:a[1]||(a[1]=e=>D("content"))},[s("span",Oe,d(k(w).data.searchItem0||"Content"),1),C(r,{name:"chevron-down"})]),s("div",De,[s("ul",null,[(n(!0),o(b,null,x(T.value,e=>(n(),o("li",{key:e,class:g([{active:i.value.includes(e.type)},"p4"]),onClick:t=>S(e.type)},[s("button",null,d(e.title),1)],10,He))),128))])])],2)):f("",!0),F.value.length?(n(),o("div",{key:1,class:g(["filter-item",{active:L.value.includes("industry")}])},[s("button",{class:"filter-category",onClick:a[2]||(a[2]=e=>D("industry"))},[s("span",Re,d(k(w).data.searchItem1||"Sectors"),1),C(r,{name:"chevron-down"})]),s("div",Ue,[s("ul",null,[(n(!0),o(b,null,x(F.value,e=>(n(),o("li",{key:e,class:g([{active:i.value.includes(e.title)},"p4"]),onClick:t=>S(e.title)},[s("button",null,d(e.title),1)],10,je))),128))])])],2)):f("",!0),A.value.length?(n(),o("div",{key:2,class:g(["filter-item",{active:L.value.includes("services")}])},[s("button",{class:"filter-category",onClick:a[3]||(a[3]=e=>D("services"))},[s("span",ze,d(k(w).data.searchItem2||"Services"),1),C(r,{name:"chevron-down"})]),s("div",Ge,[s("ul",null,[(n(!0),o(b,null,x(A.value,e=>(n(),o("li",{key:e,class:g([{active:i.value.includes(e.title)},"p4"]),onClick:t=>S(e.title)},[s("button",null,d(e.title),1)],10,Je))),128))])])],2)):f("",!0)])])],2)):f("",!0)],64)}}});const Ze=he(Ke,[["__scopeId","data-v-1597c2a6"]]);export{Ze as default};
